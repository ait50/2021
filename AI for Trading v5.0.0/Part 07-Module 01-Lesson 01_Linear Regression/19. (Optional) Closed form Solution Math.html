<!-- udacimak v1.4.4 -->
<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="ie=edge" http-equiv="X-UA-Compatible"/>
  <title>
   (Optional) Closed form Solution Math
  </title>
  <link href="../assets/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="../assets/css/plyr.css" rel="stylesheet"/>
  <link href="../assets/css/katex.min.css" rel="stylesheet"/>
  <link href="../assets/css/jquery.mCustomScrollbar.min.css" rel="stylesheet"/>
  <link href="../assets/css/styles.css" rel="stylesheet"/>
  <link href="../assets/img/udacimak.png" rel="shortcut icon" type="image/png">
  </link>
 </head>
 <body>
  <div class="wrapper">
   <nav id="sidebar">
    <div class="sidebar-header">
     <h3>
      Linear Regression
     </h3>
    </div>
    <ul class="sidebar-list list-unstyled CTAs">
     <li>
      <a class="article" href="../index.html">
       Back to Home
      </a>
     </li>
    </ul>
    <ul class="sidebar-list list-unstyled components">
     <li class="">
      <a href="01. Intro.html">
       01. Intro
      </a>
     </li>
     <li class="">
      <a href="02. Quiz Housing Prices.html">
       02. Quiz: Housing Prices
      </a>
     </li>
     <li class="">
      <a href="03. Solution Housing Prices.html">
       03. Solution: Housing Prices
      </a>
     </li>
     <li class="">
      <a href="04. Fitting a Line Through Data.html">
       04. Fitting a Line Through Data
      </a>
     </li>
     <li class="">
      <a href="05. Moving a Line.html">
       05. Moving a Line
      </a>
     </li>
     <li class="">
      <a href="06. Absolute Trick.html">
       06. Absolute Trick
      </a>
     </li>
     <li class="">
      <a href="07. Square Trick.html">
       07. Square Trick
      </a>
     </li>
     <li class="">
      <a href="08. Gradient Descent.html">
       08. Gradient Descent
      </a>
     </li>
     <li class="">
      <a href="09. Mean Absolute Error.html">
       09. Mean Absolute Error
      </a>
     </li>
     <li class="">
      <a href="10. Mean Squared Error.html">
       10. Mean Squared Error
      </a>
     </li>
     <li class="">
      <a href="11. Minimizing Error Functions.html">
       11. Minimizing Error Functions
      </a>
     </li>
     <li class="">
      <a href="12. Mean vs Total Error.html">
       12. Mean vs Total Error
      </a>
     </li>
     <li class="">
      <a href="13. Mini-batch Gradient Descent.html">
       13. Mini-batch Gradient Descent
      </a>
     </li>
     <li class="">
      <a href="14. Absolute Error vs Squared Error.html">
       14. Absolute Error vs Squared Error
      </a>
     </li>
     <li class="">
      <a href="15. Linear Regression in scikit-learn.html">
       15. Linear Regression in scikit-learn
      </a>
     </li>
     <li class="">
      <a href="16. Higher Dimensions.html">
       16. Higher Dimensions
      </a>
     </li>
     <li class="">
      <a href="17. Multiple Linear Regression.html">
       17. Multiple Linear Regression
      </a>
     </li>
     <li class="">
      <a href="18. Closed Form Solution.html">
       18. Closed Form Solution
      </a>
     </li>
     <li class="">
      <a href="19. (Optional) Closed form Solution Math.html">
       19. (Optional) Closed form Solution Math
      </a>
     </li>
     <li class="">
      <a href="20. Linear Regression Warnings.html">
       20. Linear Regression Warnings
      </a>
     </li>
     <li class="">
      <a href="21. Polynomial Regression.html">
       21. Polynomial Regression
      </a>
     </li>
     <li class="">
      <a href="22. Regularization.html">
       22. Regularization
      </a>
     </li>
     <li class="">
      <a href="23. Outro.html">
       23. Outro
      </a>
     </li>
    </ul>
    <ul class="sidebar-list list-unstyled CTAs">
     <li>
      <a class="article" href="../index.html">
       Back to Home
      </a>
     </li>
    </ul>
   </nav>
   <div id="content">
    <header class="container-fluild header">
     <div class="container">
      <div class="row">
       <div class="col-12">
        <div class="align-items-middle">
         <button class="btn btn-toggle-sidebar" id="sidebarCollapse" type="button">
          <div>
          </div>
          <div>
          </div>
          <div>
          </div>
         </button>
         <h1 style="display: inline-block">
          19. (Optional) Closed form Solution Math
         </h1>
        </div>
       </div>
      </div>
     </div>
    </header>
    <main class="container">
     <div class="row">
      <div class="col-12">
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <h1 id="optional-closed-form-solution-math">
          (Optional) Closed form solution math
         </h1>
         <p>
          In this optional section, we'll develop the math of the closed form solution, which we introduced in the last video. First, we'll do it for the 2-dimensional case, and then for the general case.
         </p>
         <h3 id="2-dimensional-solution">
          2-Dimensional solution
         </h3>
         <p>
          Our data will be the values
          <br/>
          <span class="mathquill ud-math">
           x_1, x_2, \ldots, x_m,
          </span>
          <br/>
          and our labels will be the values
          <br/>
          <span class="mathquill ud-math">
           y_1,y_2, \ldots, y_n.
          </span>
          <br/>
          Let's call our weights
          <br/>
          <span class="mathquill ud-math">
           w_1,
          </span>
          <br/>
          and
          <br/>
          <span class="mathquill ud-math">
           w_2.
          </span>
          <br/>
          Therefore, our predictions are
          <br/>
          <span class="mathquill ud-math">
           \hat{y_i} = w_1x_i + w_2.
          </span>
          <br/>
          The mean squared error is
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <figure class="figure">
          <img alt="" class="img img-fluid" src="img/f4.gif"/>
          <figcaption class="figure-caption">
          </figcaption>
         </figure>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <p>
          We need to minimize this error function. Therefore, the factor of
          <br/>
          <span class="mathquill ud-math">
           \frac{1}{m}
          </span>
          <br/>
          can be ignored. Now, replacing the value of
          <br/>
          <span class="mathquill ud-math">
           \hat{y},
          </span>
          <br/>
          we get
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <figure class="figure">
          <img alt="" class="img img-fluid" src="img/f6.gif"/>
          <figcaption class="figure-caption">
          </figcaption>
         </figure>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <p>
          Now, in order to minimize this error function, we need to take the derivatives with respect to
          <br/>
          <span class="mathquill ud-math">
           w_1
          </span>
          <br/>
          and
          <br/>
          <span class="mathquill ud-math">
           w_2
          </span>
          <br/>
          and set them equal to
          <br/>
          <span class="mathquill ud-math">
           0.
          </span>
         </p>
         <p>
          Using the chain rule, we get
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <figure class="figure">
          <img alt="" class="img img-fluid" src="img/f1.gif"/>
          <figcaption class="figure-caption">
          </figcaption>
         </figure>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <p>
          and
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <figure class="figure">
          <img alt="" class="img img-fluid" src="img/f2.gif"/>
          <figcaption class="figure-caption">
          </figcaption>
         </figure>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <p>
          Setting the two equations to zero gives us the following system of two equations and two variables (where the variables are
          <br/>
          <span class="mathquill ud-math">
           w_1
          </span>
          <br/>
          and
          <br/>
          <span class="mathquill ud-math">
           w_2
          </span>
          ).
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <figure class="figure">
          <img alt="" class="img img-fluid" src="img/codecogseqn-61.gif"/>
          <figcaption class="figure-caption">
          </figcaption>
         </figure>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <p>
          We can use any method to solve 2 equations and 2 variables. For example, if we multiply the first equation by
          <br/>
          <span class="mathquill ud-math">
           \sum_{i=1}^m x_i
          </span>
          ,
          <br/>
          the second one by
          <br/>
          <span class="mathquill ud-math">
           m
          </span>
          ,
          <br/>
          subtract them to obtain a value for
          <br/>
          <span class="mathquill ud-math">
           w_1
          </span>
          ,
          <br/>
          and then replace this value in the first equation, we get the following:
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <figure class="figure">
          <img alt="" class="img img-fluid" src="img/f4.gif"/>
          <figcaption class="figure-caption">
          </figcaption>
         </figure>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <p>
          That's our desired solution.
         </p>
         <h3 id="n-dimensional-solution">
          n-Dimensional solution
         </h3>
         <p>
          Now, let's do this when our data has n dimensions, instead of 2. In order to do this, we'll introduce the following notation. Our matrix
          <br/>
          <span class="mathquill ud-math">
           X
          </span>
          <br/>
          containing the data is the following, where each row is one of our datapoints, and
          <br/>
          <span class="mathquill ud-math">
           x_0^{(i)} =1
          </span>
          <br/>
          to represent the bias.
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <figure class="figure">
          <img alt="" class="img img-fluid" src="img/m.gif"/>
          <figcaption class="figure-caption">
          </figcaption>
         </figure>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <p>
          Our labels are the vector
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <figure class="figure">
          <img alt="" class="img img-fluid" src="img/y.gif"/>
          <figcaption class="figure-caption">
          </figcaption>
         </figure>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <p>
          and our weight matrix is the following:
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <figure class="figure">
          <img alt="" class="img img-fluid" src="img/codecogseqn-62.gif"/>
          <figcaption class="figure-caption">
          </figcaption>
         </figure>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <p>
          And so the equation for the mean square error can be written as the following matrix product:
         </p>
         <p>
          <span class="mathquill ud-math">
           E(W) = \frac{1}{m} ((XW)^T - y^T) (XW - y)
          </span>
          .
         </p>
         <p>
          Again, since we need to minimize it, we can forget about the factor of
          <br/>
          <span class="mathquill ud-math">
           \frac{1}{m}
          </span>
          , so expanding, we get
         </p>
         <p>
          <span class="mathquill ud-math">
           E(W) = W^TX^TXW - (XW)^Ty - y^T(XW) + y^Ty
          </span>
          .
         </p>
         <p>
          Notice that in the sum above, the second and the third terms are the same, since it's the inner product of two vectors, which means it's the sum of the products of its coordinates. Therefore,
         </p>
         <p>
          <span class="mathquill ud-math">
           E(W) = W^TX^TXW - 2(XW)^Ty + y^Ty
          </span>
          .
         </p>
         <p>
          Now, to minimize this, we need to take the derivative with respect to all values in the matrix
          <br/>
          <span class="mathquill ud-math">
           W
          </span>
          . Using the chain rule, as we used above, we get the following:
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <figure class="figure">
          <img alt="" class="img img-fluid" src="img/e.gif"/>
          <figcaption class="figure-caption">
          </figcaption>
         </figure>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <p>
          And in order to set this equal to zero, we need
         </p>
         <p>
          <span class="mathquill ud-math">
           X^TXW - X^Ty = 0
          </span>
          ,
          <br/>
          or equivalently,
         </p>
         <p>
          <span class="mathquill ud-math">
           W = (X^TX)^{-1} X^T y
          </span>
          .
         </p>
         <p>
          That's it, that's our closed form solution for
          <br/>
          <span class="mathquill ud-math">
           W
          </span>
          !
         </p>
         <p>
          As we stated in the video, this method will be expensive in real life, since finding the inverse of the matrix
          <br/>
          <span class="mathquill ud-math">
           X^TX
          </span>
          is hard, if
          <br/>
          <span class="mathquill ud-math">
           n
          </span>
          <br/>
          is large. That's why we go through the pain of doing gradient descent many times. But if our data is sparse, namely, if most of the entries of the matrix
          <br/>
          <span class="mathquill ud-math">
           X
          </span>
          <br/>
          are zero, there are some very interesting algorithms which will find this inverse quickly, and that'll make this method useful in real life.
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
      </div>
      <div class="col-12">
       <p class="text-right">
        <a class="btn btn-outline-primary mt-4" href="20. Linear Regression Warnings.html" role="button">
         Next Concept
        </a>
       </p>
      </div>
     </div>
    </main>
    <footer class="footer">
     <div class="container">
      <div class="row">
       <div class="col-12">
        <p class="text-center">
         udacity2.0 If you need the newest courses Plase add me wechat: udacity6
        </p>
       </div>
      </div>
     </div>
    </footer>
   </div>
  </div>
  <script src="../assets/js/jquery-3.3.1.min.js">
  </script>
  <script src="../assets/js/plyr.polyfilled.min.js">
  </script>
  <script src="../assets/js/bootstrap.min.js">
  </script>
  <script src="../assets/js/jquery.mCustomScrollbar.concat.min.js">
  </script>
  <script src="../assets/js/katex.min.js">
  </script>
  <script>
   // Initialize Plyr video players
    const players = Array.from(document.querySelectorAll('video')).map(p => new Plyr(p));

    // render math equations
    let elMath = document.getElementsByClassName('mathquill');
    for (let i = 0, len = elMath.length; i < len; i += 1) {
      const el = elMath[i];

      katex.render(el.textContent, el, {
        throwOnError: false
      });
    }

    // this hack will make sure Bootstrap tabs work when using Handlebars
    if ($('#question-tabs').length && $('#user-answer-tabs').length) {
      $("#question-tabs a.nav-link").on('click', function () {
        $("#question-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
      $("#user-answer-tabs a.nav-link").on('click', function () {
        $("#user-answer-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
    } else {
      $("a.nav-link").on('click', function () {
        $(".tab-pane").hide();
        $($(this).attr("href")).show();
      });
    }

    // side bar events
    $(document).ready(function () {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });

      // scroll to first video on page loading
      if ($('video').length) {
        $('html,body').animate({ scrollTop: $('div.plyr').prev().offset().top});
      }

      // auto play first video: this may not work with chrome/safari due to autoplay policy
      if (players && players.length > 0) {
        players[0].play();
      }

      // scroll sidebar to current concept
      const currentInSideBar = $( "ul.sidebar-list.components li a:contains('19. (Optional) Closed form Solution Math')" )
      currentInSideBar.css( "text-decoration", "underline" );
      $("#sidebar").mCustomScrollbar('scrollTo', currentInSideBar);
    });
  </script>
 </body>
</html>

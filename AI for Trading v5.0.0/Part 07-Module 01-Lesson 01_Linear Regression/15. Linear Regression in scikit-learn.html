<!-- udacimak v1.4.4 -->
<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="ie=edge" http-equiv="X-UA-Compatible"/>
  <title>
   Linear Regression in scikit-learn
  </title>
  <link href="../assets/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="../assets/css/plyr.css" rel="stylesheet"/>
  <link href="../assets/css/katex.min.css" rel="stylesheet"/>
  <link href="../assets/css/jquery.mCustomScrollbar.min.css" rel="stylesheet"/>
  <link href="../assets/css/styles.css" rel="stylesheet"/>
  <link href="../assets/img/udacimak.png" rel="shortcut icon" type="image/png">
  </link>
 </head>
 <body>
  <div class="wrapper">
   <nav id="sidebar">
    <div class="sidebar-header">
     <h3>
      Linear Regression
     </h3>
    </div>
    <ul class="sidebar-list list-unstyled CTAs">
     <li>
      <a class="article" href="../index.html">
       Back to Home
      </a>
     </li>
    </ul>
    <ul class="sidebar-list list-unstyled components">
     <li class="">
      <a href="01. Intro.html">
       01. Intro
      </a>
     </li>
     <li class="">
      <a href="02. Quiz Housing Prices.html">
       02. Quiz: Housing Prices
      </a>
     </li>
     <li class="">
      <a href="03. Solution Housing Prices.html">
       03. Solution: Housing Prices
      </a>
     </li>
     <li class="">
      <a href="04. Fitting a Line Through Data.html">
       04. Fitting a Line Through Data
      </a>
     </li>
     <li class="">
      <a href="05. Moving a Line.html">
       05. Moving a Line
      </a>
     </li>
     <li class="">
      <a href="06. Absolute Trick.html">
       06. Absolute Trick
      </a>
     </li>
     <li class="">
      <a href="07. Square Trick.html">
       07. Square Trick
      </a>
     </li>
     <li class="">
      <a href="08. Gradient Descent.html">
       08. Gradient Descent
      </a>
     </li>
     <li class="">
      <a href="09. Mean Absolute Error.html">
       09. Mean Absolute Error
      </a>
     </li>
     <li class="">
      <a href="10. Mean Squared Error.html">
       10. Mean Squared Error
      </a>
     </li>
     <li class="">
      <a href="11. Minimizing Error Functions.html">
       11. Minimizing Error Functions
      </a>
     </li>
     <li class="">
      <a href="12. Mean vs Total Error.html">
       12. Mean vs Total Error
      </a>
     </li>
     <li class="">
      <a href="13. Mini-batch Gradient Descent.html">
       13. Mini-batch Gradient Descent
      </a>
     </li>
     <li class="">
      <a href="14. Absolute Error vs Squared Error.html">
       14. Absolute Error vs Squared Error
      </a>
     </li>
     <li class="">
      <a href="15. Linear Regression in scikit-learn.html">
       15. Linear Regression in scikit-learn
      </a>
     </li>
     <li class="">
      <a href="16. Higher Dimensions.html">
       16. Higher Dimensions
      </a>
     </li>
     <li class="">
      <a href="17. Multiple Linear Regression.html">
       17. Multiple Linear Regression
      </a>
     </li>
     <li class="">
      <a href="18. Closed Form Solution.html">
       18. Closed Form Solution
      </a>
     </li>
     <li class="">
      <a href="19. (Optional) Closed form Solution Math.html">
       19. (Optional) Closed form Solution Math
      </a>
     </li>
     <li class="">
      <a href="20. Linear Regression Warnings.html">
       20. Linear Regression Warnings
      </a>
     </li>
     <li class="">
      <a href="21. Polynomial Regression.html">
       21. Polynomial Regression
      </a>
     </li>
     <li class="">
      <a href="22. Regularization.html">
       22. Regularization
      </a>
     </li>
     <li class="">
      <a href="23. Outro.html">
       23. Outro
      </a>
     </li>
    </ul>
    <ul class="sidebar-list list-unstyled CTAs">
     <li>
      <a class="article" href="../index.html">
       Back to Home
      </a>
     </li>
    </ul>
   </nav>
   <div id="content">
    <header class="container-fluild header">
     <div class="container">
      <div class="row">
       <div class="col-12">
        <div class="align-items-middle">
         <button class="btn btn-toggle-sidebar" id="sidebarCollapse" type="button">
          <div>
          </div>
          <div>
          </div>
          <div>
          </div>
         </button>
         <h1 style="display: inline-block">
          15. Linear Regression in scikit-learn
         </h1>
        </div>
       </div>
      </div>
     </div>
    </header>
    <main class="container">
     <div class="row">
      <div class="col-12">
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <h1 id="linear-regression">
          Linear Regression
         </h1>
         <p>
          In this section, you'll use linear regression to predict life expectancy from
          <a href="https://en.wikipedia.org/wiki/Body_mass_index" rel="noopener noreferrer" target="_blank">
           body mass index (BMI)
          </a>
          .  Before you do that, let's go over the tools required to build this model.
         </p>
         <p>
          For your linear regression model, you'll be using scikit-learn's
          <a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html" rel="noopener noreferrer" target="_blank">
           <code>
            LinearRegression
           </code>
          </a>
          class.  This class provides the function
          <a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html#sklearn.linear_model.LinearRegression.fit" rel="noopener noreferrer" target="_blank">
           <code>
            fit()
           </code>
          </a>
          to fit the model to your data.
         </p>
         <pre><code class="python language-python">&gt;&gt;&gt; from sklearn.linear_model import LinearRegression
&gt;&gt;&gt; model = LinearRegression()
&gt;&gt;&gt; model.fit(x_values, y_values)</code></pre>
         <p>
          In the example above, the
          <code>
           model
          </code>
          variable is a linear regression model that has been fitted to the data
          <code>
           x_values
          </code>
          and
          <code>
           y_values
          </code>
          .  Fitting the model means finding the best line that fits the training data.  Let's make two predictions using the model's
          <a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html#sklearn.linear_model.LinearRegression.predict" rel="noopener noreferrer" target="_blank">
           <code>
            predict()
           </code>
          </a>
          function.
         </p>
         <pre><code class="python language-python">&gt;&gt;&gt; print(model.predict([ [127], [248] ]))
[[ 438.94308857, 127.14839521]]</code></pre>
         <p>
          The model returned an array of predictions, one prediction for each input array.  The first input,
          <code>
           [127]
          </code>
          , got a prediction of
          <code>
           438.94308857
          </code>
          .  The second input,
          <code>
           [248]
          </code>
          , got a prediction of
          <code>
           127.14839521
          </code>
          .  The reason for predicting on an array like
          <code>
           [127]
          </code>
          and not just
          <code>
           127
          </code>
          , is because you can have a model that makes a prediction using multiple features.  We'll go over using multiple variables in linear regression  later in this lesson.  For now, let's stick to a single value.
         </p>
         <h2 id="linear-regression-quiz">
          Linear Regression Quiz
         </h2>
         <p>
          In this quiz, you'll be working with data on the average life expectancy at birth and the average BMI for males across the world. The data comes from
          <a href="https://www.gapminder.org/" rel="noopener noreferrer" target="_blank">
           Gapminder
          </a>
          .
         </p>
         <p>
          The data file can be found under the "bmi_and_life_expectancy.csv" tab in the quiz below. It includes three columns, containing the following data:
         </p>
         <ul>
          <li>
           <strong>
            Country
           </strong>
           – The country the person was born in.
          </li>
          <li>
           <strong>
            Life expectancy
           </strong>
           – The average life expectancy at birth for a person in that country.
          </li>
          <li>
           <strong>
            BMI
           </strong>
           – The mean BMI of males in that country.
          </li>
         </ul>
         <h3 id="youll-need-to-complete-each-of-the-following-steps">
          You'll need to complete each of the following steps:
         </h3>
         <p>
          <strong>
           1. Load the data
          </strong>
         </p>
         <ul>
          <li>
           The data is in the file called "bmi_and_life_expectancy.csv".
          </li>
          <li>
           Use pandas
           <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_csv.html" rel="noopener noreferrer" target="_blank">
            <code>
             read_csv
            </code>
           </a>
           to load the data into a dataframe (don't forget to import pandas!)
          </li>
          <li>
           Assign the dataframe to the variable
           <code>
            bmi_life_data
           </code>
           .
          </li>
         </ul>
         <p>
          <strong>
           2. Build a linear regression model
          </strong>
         </p>
         <ul>
          <li>
           Create a regression model using scikit-learn's
           <a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html" rel="noopener noreferrer" target="_blank">
            <code>
             LinearRegression
            </code>
           </a>
           and assign it to
           <code>
            bmi_life_model
           </code>
           .
          </li>
          <li>
           Fit the model to the data.
          </li>
         </ul>
         <p>
          <strong>
           3. Predict using the model
          </strong>
         </p>
         <ul>
          <li>
           Predict using a BMI of 21.07931 and assign it to the variable
           <code>
            laos_life_exp
           </code>
           .
          </li>
         </ul>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <h4>
          Start Quiz:
         </h4>
         <div>
          <div class="nav nav-tabs nav-fill" id="question-tabs" role="tablist">
           <a aria-controls="464506-gapminder1-py" aria-selected="true" class="nav-item nav-link active show" data-toggle="tab" href="#464506-gapminder1-py" id="tab-464506-gapminder1-py" role="tab">
            gapminder1.py
           </a>
           <a aria-controls="464506-bmi_and_life_expectancy-csv" aria-selected="false" class="nav-item nav-link" data-toggle="tab" href="#464506-bmi_and_life_expectancy-csv" id="tab-464506-bmi_and_life_expectancy-csv" role="tab">
            bmi_and_life_expectancy.csv
           </a>
           <a aria-controls="464506-solution-py" aria-selected="false" class="nav-item nav-link" data-toggle="tab" href="#464506-solution-py" id="tab-464506-solution-py" role="tab">
            solution.py
           </a>
          </div>
          <div class="tab-content" id="question-tab-contents" style="padding: 20px 0;">
           <div aria-labelledby="tab-464506-gapminder1-py" class="tab-pane active show" id="464506-gapminder1-py" role="tabpanel">
            <pre><code></code># TODO: Add import statements


# Assign the dataframe to this variable.
# TODO: Load the data
bmi_life_data = None 

# Make and fit the linear regression model
#TODO: Fit the model and Assign it to bmi_life_model
bmi_life_model = None

# Make a prediction using the model
# TODO: Predict life expectancy for a BMI value of 21.07931
laos_life_exp = None
</pre>
           </div>
           <div aria-labelledby="tab-464506-bmi_and_life_expectancy-csv" class="tab-pane" id="464506-bmi_and_life_expectancy-csv" role="tabpanel">
            <pre><code></code>Country,Life expectancy,BMI
Afghanistan,52.8,20.62058
Albania,76.8,26.44657
Algeria,75.5,24.59620
Andorra,84.6,27.63048
Angola,56.7,22.25083
Armenia,72.3,25.355420000000002
Australia,81.6,27.56373
Austria,80.4,26.467409999999997
Azerbaijan,69.2,25.65117
Bahamas,72.2,27.24594
Bangladesh,68.3,20.39742
Barbados,75.3,26.38439
Belarus,70.0,26.16443
Belgium,79.6,26.75915
Belize,70.7,27.02255
Benin,59.7,22.41835
Bhutan,70.7,22.82180
Bolivia,71.2,24.43335
Bosnia and Herzegovina,77.5,26.61163
Botswana,53.2,22.12984
Brazil,73.2,25.78623
Bulgaria,73.2,26.54286
Burkina Faso,58.0,21.27157
Burundi,59.1,21.50291
Cambodia,66.1,20.80496
Cameroon,56.6,23.68173
Canada,80.8,27.45210
Cape Verde,70.4,23.51522
Chad,54.3,21.48569
Chile,78.5,27.01542
China,73.4,22.92176
Colombia,76.2,24.94041
Comoros,67.1,22.06131
"Congo, Dem. Rep.",57.5,19.86692
"Congo, Rep.",58.8,21.87134
Costa Rica,79.8,26.47897
Cote d'Ivoire,55.4,22.56469
Croatia,76.2,26.59629
Cuba,77.6,25.06867
Cyprus,80.0,27.41899
Denmark,78.9,26.13287
Djibouti,61.8,23.38403
Ecuador,74.7,25.58841
Egypt,70.2,26.73243
El Salvador,73.7,26.36751
Eritrea,60.1,20.88509
Estonia,74.2,26.26446
Ethiopia,60.0,20.24700
Fiji,64.9,26.53078
Finland,79.6,26.73339
France,81.1,25.85329
French Polynesia,75.11,30.86752
Gabon,61.7,24.07620
Gambia,65.7,21.65029
Georgia,71.8,25.54942
Germany,80.0,27.16509
Ghana,62.0,22.84247
Greece,80.2,26.33786
Greenland,70.3,26.01359
Grenada,70.8,25.17988
Guatemala,71.2,25.29947
Guinea,57.1,22.52449
Guinea-Bissau,53.6,21.64338
Guyana,65.0,23.68465
Haiti,61.0,23.66302
Honduras,71.8,25.10872
Hungary,73.9,27.11568
Iceland,82.4,27.20687
India,64.7,20.95956
Indonesia,69.4,21.85576
Iran,73.1,25.31003
Iraq,66.6,26.71017
Ireland,80.1,27.65325
Israel,80.6,27.13151
Jamaica,75.1,24.00421
Japan,82.5,23.50004
Jordan,76.9,27.47362
Kazakhstan,67.1,26.29078
Kenya,60.8,21.59258
Kuwait,77.3,29.17211
Latvia,72.4,26.45693
Lesotho,44.5,21.90157
Liberia,59.9,21.89537
Libya,75.6,26.54164
Lithuania,72.1,26.86102
Luxembourg,81.0,27.43404
"Macedonia, FYR",74.5,26.34473
Madagascar,62.2,21.40347
Malawi,52.4,22.03468
Malaysia,74.5,24.73069
Maldives,78.5,23.21991
Mali,58.5,21.78881
Malta,80.7,27.68361
Marshall Islands,65.3,29.37337
Mauritania,67.9,22.62295
Mauritius,72.9,25.15669
Mexico,75.4,27.42468
Moldova,70.4,24.23690
Mongolia,64.8,24.88385
Montenegro,76.0,26.55412
Morocco,73.3,25.63182
Mozambique,54.0,21.93536
Myanmar,59.4,21.44932
Namibia,59.1,22.65008
Nepal,68.4,20.76344
Netherlands,80.3,26.01541
Nicaragua,77.0,25.77291
Niger,58.0,21.21958
Nigeria,59.2,23.03322
Norway,80.8,26.93424
Oman,76.2,26.24109
Pakistan,64.1,22.29914
Panama,77.3,26.26959
Papua New Guinea,58.6,25.01506
Paraguay,74.0,25.54223
Peru,78.2,24.77041
Philippines,69.8,22.87263
Poland,75.4,26.67380
Portugal,79.4,26.68445
Qatar,77.9,28.13138
Romania,73.2,25.41069
Russia,67.9,26.01131
Rwanda,64.1,22.55453
Samoa,72.3,30.42475
Sao Tome and Principe,66.0,23.51233
Senegal,63.5,21.92743
Serbia,74.3,26.51495
Sierra Leone,53.6,22.53139
Singapore,80.6,23.83996
Slovak Republic,74.9,26.92717
Slovenia,78.7,27.43983
Somalia,52.6,21.96917
South Africa,53.4,26.85538
Spain,81.1,27.49975
Sri Lanka,74.0,21.96671
Sudan,65.5,22.40484
Suriname,70.2,25.49887
Swaziland,45.1,23.16969
Sweden,81.1,26.37629
Switzerland,82.0,26.20195
Syria,76.1,26.91969
Tajikistan,69.6,23.77966
Tanzania,60.4,22.47792
Thailand,73.9,23.00803
Timor-Leste,69.9,20.59082
Togo,57.5,21.87875
Tonga,70.3,30.99563
Trinidad and Tobago,71.7,26.39669
Tunisia,76.8,25.15699
Turkey,77.8,26.70371
Turkmenistan,67.2,25.24796
Uganda,56.0,22.35833
Ukraine,67.8,25.42379
United Arab Emirates,75.6,28.05359
United Kingdom,79.7,27.39249
United States,78.3,28.45698
Uruguay,76.0,26.39123
Uzbekistan,69.6,25.32054
Vanuatu,63.4,26.78926
West Bank and Gaza,74.1,26.57750
Vietnam,74.1,20.91630
Zambia,51.1,20.68321
Zimbabwe,47.3,22.02660
</pre>
           </div>
           <div aria-labelledby="tab-464506-solution-py" class="tab-pane" id="464506-solution-py" role="tabpanel">
            <pre><code></code># TODO: Add import statements
import pandas as pd
from sklearn.linear_model import LinearRegression

# Assign the dataframe to this variable.
# TODO: Load the data
bmi_life_data = pd.read_csv("bmi_and_life_expectancy.csv")

# Make and fit the linear regression model
#TODO: Fit the model and Assign it to bmi_life_model
bmi_life_model = LinearRegression()
bmi_life_model.fit(bmi_life_data[['BMI']], bmi_life_data[['Life expectancy']])

# Mak a prediction using the model
# TODO: Predict life expectancy for a BMI value of 21.07931
laos_life_exp = bmi_life_model.predict(21.07931)
</pre>
           </div>
          </div>
         </div>
        </div>
       </div>
       <div class="divider">
       </div>
      </div>
      <div class="col-12">
       <p class="text-right">
        <a class="btn btn-outline-primary mt-4" href="16. Higher Dimensions.html" role="button">
         Next Concept
        </a>
       </p>
      </div>
     </div>
    </main>
    <footer class="footer">
     <div class="container">
      <div class="row">
       <div class="col-12">
        <p class="text-center">
         udacity2.0 If you need the newest courses Plase add me wechat: udacity6
        </p>
       </div>
      </div>
     </div>
    </footer>
   </div>
  </div>
  <script src="../assets/js/jquery-3.3.1.min.js">
  </script>
  <script src="../assets/js/plyr.polyfilled.min.js">
  </script>
  <script src="../assets/js/bootstrap.min.js">
  </script>
  <script src="../assets/js/jquery.mCustomScrollbar.concat.min.js">
  </script>
  <script src="../assets/js/katex.min.js">
  </script>
  <script>
   // Initialize Plyr video players
    const players = Array.from(document.querySelectorAll('video')).map(p => new Plyr(p));

    // render math equations
    let elMath = document.getElementsByClassName('mathquill');
    for (let i = 0, len = elMath.length; i < len; i += 1) {
      const el = elMath[i];

      katex.render(el.textContent, el, {
        throwOnError: false
      });
    }

    // this hack will make sure Bootstrap tabs work when using Handlebars
    if ($('#question-tabs').length && $('#user-answer-tabs').length) {
      $("#question-tabs a.nav-link").on('click', function () {
        $("#question-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
      $("#user-answer-tabs a.nav-link").on('click', function () {
        $("#user-answer-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
    } else {
      $("a.nav-link").on('click', function () {
        $(".tab-pane").hide();
        $($(this).attr("href")).show();
      });
    }

    // side bar events
    $(document).ready(function () {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });

      // scroll to first video on page loading
      if ($('video').length) {
        $('html,body').animate({ scrollTop: $('div.plyr').prev().offset().top});
      }

      // auto play first video: this may not work with chrome/safari due to autoplay policy
      if (players && players.length > 0) {
        players[0].play();
      }

      // scroll sidebar to current concept
      const currentInSideBar = $( "ul.sidebar-list.components li a:contains('15. Linear Regression in scikit-learn')" )
      currentInSideBar.css( "text-decoration", "underline" );
      $("#sidebar").mCustomScrollbar('scrollTo', currentInSideBar);
    });
  </script>
 </body>
</html>

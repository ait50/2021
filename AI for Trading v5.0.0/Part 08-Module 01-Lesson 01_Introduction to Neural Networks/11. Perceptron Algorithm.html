<!-- udacimak v1.4.4 -->
<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="ie=edge" http-equiv="X-UA-Compatible"/>
  <title>
   Perceptron Algorithm
  </title>
  <link href="../assets/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="../assets/css/plyr.css" rel="stylesheet"/>
  <link href="../assets/css/katex.min.css" rel="stylesheet"/>
  <link href="../assets/css/jquery.mCustomScrollbar.min.css" rel="stylesheet"/>
  <link href="../assets/css/styles.css" rel="stylesheet"/>
  <link href="../assets/img/udacimak.png" rel="shortcut icon" type="image/png">
  </link>
 </head>
 <body>
  <div class="wrapper">
   <nav id="sidebar">
    <div class="sidebar-header">
     <h3>
      Introduction to Neural Networks
     </h3>
    </div>
    <ul class="sidebar-list list-unstyled CTAs">
     <li>
      <a class="article" href="../index.html">
       Back to Home
      </a>
     </li>
    </ul>
    <ul class="sidebar-list list-unstyled components">
     <li class="">
      <a href="01. Instructor.html">
       01. Instructor
      </a>
     </li>
     <li class="">
      <a href="02. Introduction.html">
       02. Introduction
      </a>
     </li>
     <li class="">
      <a href="03. Classification Problems 1.html">
       03. Classification Problems 1
      </a>
     </li>
     <li class="">
      <a href="04. Classification Problems 2.html">
       04. Classification Problems 2
      </a>
     </li>
     <li class="">
      <a href="05. Linear Boundaries.html">
       05. Linear Boundaries
      </a>
     </li>
     <li class="">
      <a href="06. Higher Dimensions.html">
       06. Higher Dimensions
      </a>
     </li>
     <li class="">
      <a href="07. Perceptrons.html">
       07. Perceptrons
      </a>
     </li>
     <li class="">
      <a href="08. Why Neural Networks.html">
       08. Why "Neural Networks"?
      </a>
     </li>
     <li class="">
      <a href="09. Perceptrons as Logical Operators.html">
       09. Perceptrons as Logical Operators
      </a>
     </li>
     <li class="">
      <a href="10. Perceptron Trick.html">
       10. Perceptron Trick
      </a>
     </li>
     <li class="">
      <a href="11. Perceptron Algorithm.html">
       11. Perceptron Algorithm
      </a>
     </li>
     <li class="">
      <a href="12. Non-Linear Regions.html">
       12. Non-Linear Regions
      </a>
     </li>
     <li class="">
      <a href="13. Error Functions.html">
       13. Error Functions
      </a>
     </li>
     <li class="">
      <a href="14. Log-loss Error Function.html">
       14. Log-loss Error Function
      </a>
     </li>
     <li class="">
      <a href="15. Discrete vs Continuous.html">
       15. Discrete vs Continuous
      </a>
     </li>
     <li class="">
      <a href="16. Softmax.html">
       16. Softmax
      </a>
     </li>
     <li class="">
      <a href="17. One-Hot Encoding.html">
       17. One-Hot Encoding
      </a>
     </li>
     <li class="">
      <a href="18. Maximum Likelihood.html">
       18. Maximum Likelihood
      </a>
     </li>
     <li class="">
      <a href="19. Maximizing Probabilities.html">
       19. Maximizing Probabilities
      </a>
     </li>
     <li class="">
      <a href="20. Cross-Entropy 1.html">
       20. Cross-Entropy 1
      </a>
     </li>
     <li class="">
      <a href="21. Cross-Entropy 2.html">
       21. Cross-Entropy 2
      </a>
     </li>
     <li class="">
      <a href="22. Multi-Class Cross Entropy.html">
       22. Multi-Class Cross Entropy
      </a>
     </li>
     <li class="">
      <a href="23. Logistic Regression.html">
       23. Logistic Regression
      </a>
     </li>
     <li class="">
      <a href="24. Gradient Descent.html">
       24. Gradient Descent
      </a>
     </li>
     <li class="">
      <a href="25. Logistic Regression Algorithm.html">
       25. Logistic Regression Algorithm
      </a>
     </li>
     <li class="">
      <a href="26. Pre-Notebook Gradient Descent.html">
       26. Pre-Notebook: Gradient Descent
      </a>
     </li>
     <li class="">
      <a href="27. Notebook Gradient Descent.html">
       27. Notebook: Gradient Descent
      </a>
     </li>
     <li class="">
      <a href="28. Perceptron vs Gradient Descent.html">
       28. Perceptron vs Gradient Descent
      </a>
     </li>
     <li class="">
      <a href="29. Continuous Perceptrons.html">
       29. Continuous Perceptrons
      </a>
     </li>
     <li class="">
      <a href="30. Non-linear Data.html">
       30. Non-linear Data
      </a>
     </li>
     <li class="">
      <a href="31. Non-Linear Models.html">
       31. Non-Linear Models
      </a>
     </li>
     <li class="">
      <a href="32. Neural Network Architecture.html">
       32. Neural Network Architecture
      </a>
     </li>
     <li class="">
      <a href="33. Feedforward.html">
       33. Feedforward
      </a>
     </li>
     <li class="">
      <a href="34. Backpropagation.html">
       34. Backpropagation
      </a>
     </li>
     <li class="">
      <a href="35. Pre-Notebook Analyzing Student Data.html">
       35. Pre-Notebook: Analyzing Student Data
      </a>
     </li>
     <li class="">
      <a href="36. Notebook Analyzing Student Data.html">
       36. Notebook: Analyzing Student Data
      </a>
     </li>
     <li class="">
      <a href="37. Outro.html">
       37. Outro
      </a>
     </li>
    </ul>
    <ul class="sidebar-list list-unstyled CTAs">
     <li>
      <a class="article" href="../index.html">
       Back to Home
      </a>
     </li>
    </ul>
   </nav>
   <div id="content">
    <header class="container-fluild header">
     <div class="container">
      <div class="row">
       <div class="col-12">
        <div class="align-items-middle">
         <button class="btn btn-toggle-sidebar" id="sidebarCollapse" type="button">
          <div>
          </div>
          <div>
          </div>
          <div>
          </div>
         </button>
         <h1 style="display: inline-block">
          11. Perceptron Algorithm
         </h1>
        </div>
       </div>
      </div>
     </div>
    </header>
    <main class="container">
     <div class="row">
      <div class="col-12">
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <h1 id="perceptron-algorithm">
          Perceptron Algorithm
         </h1>
         <p>
          And now, with the perceptron trick in our hands, we can fully develop the perceptron algorithm! The following video will show you the pseudocode, and in the quiz below, you'll have the chance to code it in Python.
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
         <p>
          Perceptron Algorithm Pseudocode
         </p>
        </h3>
        <video controls="">
         <source src="11. Perceptron Algorithm Pseudocode-p8Q3yu9YqYk.mp4" type="video/mp4"/>
         <track default="true" kind="subtitles" label="en" src="11. Perceptron Algorithm Pseudocode-p8Q3yu9YqYk.en.vtt" srclang="en"/>
         <track default="false" kind="subtitles" label="pt-BR" src="11. Perceptron Algorithm Pseudocode-p8Q3yu9YqYk.pt-BR.vtt" srclang="pt-BR"/>
         <track default="false" kind="subtitles" label="ja-JP" src="11. Perceptron Algorithm Pseudocode-p8Q3yu9YqYk.ja-JP.vtt" srclang="ja-JP"/>
        </video>
        <div class="jumbotron" style="margin-top: 50px; margin-bottom: 50px;">
         <h3>
          INSTRUCTOR NOTE:
         </h3>
         <p>
          There's a small error in the above video in that
          <span class="mathquill ud-math">
           W_i
          </span>
          should be updated to
          <span class="mathquill ud-math">
           W_i  = W_i + \alpha x_i
          </span>
          (plus or minus depending on the situation).
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <h1 id="coding-the-perceptron-algorithm">
          Coding the Perceptron Algorithm
         </h1>
         <p>
          Time to code! In this quiz, you'll have the chance to implement the perceptron algorithm to separate the following data (given in the file data.csv).
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <figure class="figure">
          <img alt="" class="img img-fluid" src="img/points.png"/>
          <figcaption class="figure-caption">
          </figcaption>
         </figure>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <p>
          Recall that the perceptron step works as follows. For a point with coordinates
          <br/>
          <span class="mathquill ud-math">
           (p,q)
          </span>
          , label
          <span class="mathquill ud-math">
           y
          </span>
          , and prediction given by the equation
          <span class="mathquill ud-math">
           \hat{y} = step(w_1x_1 + w_2x_2 + b)
          </span>
          :
         </p>
         <ul>
          <li>
           If the point is correctly classified, do nothing.
          </li>
          <li>
           If the point is classified positive, but it has a negative label, subtract
           <br/>
           <span class="mathquill ud-math">
            \alpha p, \alpha q,
           </span>
           and
           <br/>
           <span class="mathquill ud-math">
            \alpha
           </span>
           <br/>
           from
           <br/>
           <span class="mathquill ud-math">
            w_1, w_2,
           </span>
           <br/>
           and
           <br/>
           <span class="mathquill ud-math">
            b
           </span>
           <br/>
           respectively.
          </li>
          <li>
           If the point is classified negative, but it has a positive label, add
           <br/>
           <span class="mathquill ud-math">
            \alpha p, \alpha q,
           </span>
           <br/>
           and
           <br/>
           <span class="mathquill ud-math">
            \alpha
           </span>
           <br/>
           to
           <br/>
           <span class="mathquill ud-math">
            w_1, w_2,
           </span>
           <br/>
           and
           <br/>
           <span class="mathquill ud-math">
            b
           </span>
           <br/>
           respectively.
          </li>
         </ul>
         <p>
          Then click on
          <code>
           test run
          </code>
          to graph the solution that the perceptron algorithm gives you. It'll actually draw a set of dotted lines, that show how the algorithm approaches to the best solution, given by the black solid line.
         </p>
         <p>
          Feel free to play with the parameters of the algorithm (number of epochs, learning rate, and even the randomizing of the initial parameters) to see how your initial conditions can affect the solution!
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <h4>
          Start Quiz:
         </h4>
         <div>
          <div class="nav nav-tabs nav-fill" id="question-tabs" role="tablist">
           <a aria-controls="308040-perceptron-py" aria-selected="true" class="nav-item nav-link active show" data-toggle="tab" href="#308040-perceptron-py" id="tab-308040-perceptron-py" role="tab">
            perceptron.py
           </a>
           <a aria-controls="308040-data-csv" aria-selected="false" class="nav-item nav-link" data-toggle="tab" href="#308040-data-csv" id="tab-308040-data-csv" role="tab">
            data.csv
           </a>
           <a aria-controls="308040-solution-py" aria-selected="false" class="nav-item nav-link" data-toggle="tab" href="#308040-solution-py" id="tab-308040-solution-py" role="tab">
            solution.py
           </a>
          </div>
          <div class="tab-content" id="question-tab-contents" style="padding: 20px 0;">
           <div aria-labelledby="tab-308040-perceptron-py" class="tab-pane active show" id="308040-perceptron-py" role="tabpanel">
            <pre><code></code>import numpy as np
# Setting the random seed, feel free to change it and see different solutions.
np.random.seed(42)

def stepFunction(t):
    if t &gt;= 0:
        return 1
    return 0

def prediction(X, W, b):
    return stepFunction((np.matmul(X,W)+b)[0])

# TODO: Fill in the code below to implement the perceptron trick.
# The function should receive as inputs the data X, the labels y,
# the weights W (as an array), and the bias b,
# update the weights and bias W, b, according to the perceptron algorithm,
# and return W and b.
def perceptronStep(X, y, W, b, learn_rate = 0.01):
    # Fill in code
    return W, b
    
# This function runs the perceptron algorithm repeatedly on the dataset,
# and returns a few of the boundary lines obtained in the iterations,
# for plotting purposes.
# Feel free to play with the learning rate and the num_epochs,
# and see your results plotted below.
def trainPerceptronAlgorithm(X, y, learn_rate = 0.01, num_epochs = 25):
    x_min, x_max = min(X.T[0]), max(X.T[0])
    y_min, y_max = min(X.T[1]), max(X.T[1])
    W = np.array(np.random.rand(2,1))
    b = np.random.rand(1)[0] + x_max
    # These are the solution lines that get plotted below.
    boundary_lines = []
    for i in range(num_epochs):
        # In each epoch, we apply the perceptron step.
        W, b = perceptronStep(X, y, W, b, learn_rate)
        boundary_lines.append((-W[0]/W[1], -b/W[1]))
    return boundary_lines
</pre>
           </div>
           <div aria-labelledby="tab-308040-data-csv" class="tab-pane" id="308040-data-csv" role="tabpanel">
            <pre><code></code>0.78051,-0.063669,1
0.28774,0.29139,1
0.40714,0.17878,1
0.2923,0.4217,1
0.50922,0.35256,1
0.27785,0.10802,1
0.27527,0.33223,1
0.43999,0.31245,1
0.33557,0.42984,1
0.23448,0.24986,1
0.0084492,0.13658,1
0.12419,0.33595,1
0.25644,0.42624,1
0.4591,0.40426,1
0.44547,0.45117,1
0.42218,0.20118,1
0.49563,0.21445,1
0.30848,0.24306,1
0.39707,0.44438,1
0.32945,0.39217,1
0.40739,0.40271,1
0.3106,0.50702,1
0.49638,0.45384,1
0.10073,0.32053,1
0.69907,0.37307,1
0.29767,0.69648,1
0.15099,0.57341,1
0.16427,0.27759,1
0.33259,0.055964,1
0.53741,0.28637,1
0.19503,0.36879,1
0.40278,0.035148,1
0.21296,0.55169,1
0.48447,0.56991,1
0.25476,0.34596,1
0.21726,0.28641,1
0.67078,0.46538,1
0.3815,0.4622,1
0.53838,0.32774,1
0.4849,0.26071,1
0.37095,0.38809,1
0.54527,0.63911,1
0.32149,0.12007,1
0.42216,0.61666,1
0.10194,0.060408,1
0.15254,0.2168,1
0.45558,0.43769,1
0.28488,0.52142,1
0.27633,0.21264,1
0.39748,0.31902,1
0.5533,1,0
0.44274,0.59205,0
0.85176,0.6612,0
0.60436,0.86605,0
0.68243,0.48301,0
1,0.76815,0
0.72989,0.8107,0
0.67377,0.77975,0
0.78761,0.58177,0
0.71442,0.7668,0
0.49379,0.54226,0
0.78974,0.74233,0
0.67905,0.60921,0
0.6642,0.72519,0
0.79396,0.56789,0
0.70758,0.76022,0
0.59421,0.61857,0
0.49364,0.56224,0
0.77707,0.35025,0
0.79785,0.76921,0
0.70876,0.96764,0
0.69176,0.60865,0
0.66408,0.92075,0
0.65973,0.66666,0
0.64574,0.56845,0
0.89639,0.7085,0
0.85476,0.63167,0
0.62091,0.80424,0
0.79057,0.56108,0
0.58935,0.71582,0
0.56846,0.7406,0
0.65912,0.71548,0
0.70938,0.74041,0
0.59154,0.62927,0
0.45829,0.4641,0
0.79982,0.74847,0
0.60974,0.54757,0
0.68127,0.86985,0
0.76694,0.64736,0
0.69048,0.83058,0
0.68122,0.96541,0
0.73229,0.64245,0
0.76145,0.60138,0
0.58985,0.86955,0
0.73145,0.74516,0
0.77029,0.7014,0
0.73156,0.71782,0
0.44556,0.57991,0
0.85275,0.85987,0
0.51912,0.62359,0
</pre>
           </div>
           <div aria-labelledby="tab-308040-solution-py" class="tab-pane" id="308040-solution-py" role="tabpanel">
            <pre><code></code>def perceptronStep(X, y, W, b, learn_rate = 0.01):
    for i in range(len(X)):
        y_hat = prediction(X[i],W,b)
        if y[i]-y_hat == 1:
            W[0] += X[i][0]*learn_rate
            W[1] += X[i][1]*learn_rate
            b += learn_rate
        elif y[i]-y_hat == -1:
            W[0] -= X[i][0]*learn_rate
            W[1] -= X[i][1]*learn_rate
            b -= learn_rate
    return W, b
</pre>
           </div>
          </div>
         </div>
        </div>
       </div>
       <div class="divider">
       </div>
      </div>
      <div class="col-12">
       <p class="text-right">
        <a class="btn btn-outline-primary mt-4" href="12. Non-Linear Regions.html" role="button">
         Next Concept
        </a>
       </p>
      </div>
     </div>
    </main>
    <footer class="footer">
     <div class="container">
      <div class="row">
       <div class="col-12">
        <p class="text-center">
         udacity2.0 If you need the newest courses Plase add me wechat: udacity6
        </p>
       </div>
      </div>
     </div>
    </footer>
   </div>
  </div>
  <script src="../assets/js/jquery-3.3.1.min.js">
  </script>
  <script src="../assets/js/plyr.polyfilled.min.js">
  </script>
  <script src="../assets/js/bootstrap.min.js">
  </script>
  <script src="../assets/js/jquery.mCustomScrollbar.concat.min.js">
  </script>
  <script src="../assets/js/katex.min.js">
  </script>
  <script>
   // Initialize Plyr video players
    const players = Array.from(document.querySelectorAll('video')).map(p => new Plyr(p));

    // render math equations
    let elMath = document.getElementsByClassName('mathquill');
    for (let i = 0, len = elMath.length; i < len; i += 1) {
      const el = elMath[i];

      katex.render(el.textContent, el, {
        throwOnError: false
      });
    }

    // this hack will make sure Bootstrap tabs work when using Handlebars
    if ($('#question-tabs').length && $('#user-answer-tabs').length) {
      $("#question-tabs a.nav-link").on('click', function () {
        $("#question-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
      $("#user-answer-tabs a.nav-link").on('click', function () {
        $("#user-answer-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
    } else {
      $("a.nav-link").on('click', function () {
        $(".tab-pane").hide();
        $($(this).attr("href")).show();
      });
    }

    // side bar events
    $(document).ready(function () {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });

      // scroll to first video on page loading
      if ($('video').length) {
        $('html,body').animate({ scrollTop: $('div.plyr').prev().offset().top});
      }

      // auto play first video: this may not work with chrome/safari due to autoplay policy
      if (players && players.length > 0) {
        players[0].play();
      }

      // scroll sidebar to current concept
      const currentInSideBar = $( "ul.sidebar-list.components li a:contains('11. Perceptron Algorithm')" )
      currentInSideBar.css( "text-decoration", "underline" );
      $("#sidebar").mCustomScrollbar('scrollTo', currentInSideBar);
    });
  </script>
 </body>
</html>

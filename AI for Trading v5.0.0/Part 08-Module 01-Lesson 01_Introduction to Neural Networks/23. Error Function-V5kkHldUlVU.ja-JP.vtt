WEBVTT
Kind: captions
Language: ja-JP

00:00:00.000 --> 00:00:03.632
このへんで これまでのレッスンを 簡単に まとめてみましょう

00:00:03.632 --> 00:00:05.640
ここに 2つの モデルがあります

00:00:05.639 --> 00:00:08.934
左は 良くないモデル 右は 良いモデルです

00:00:08.935 --> 00:00:13.440
どちらに対しても クロスエントロピーを 求めるため

00:00:13.439 --> 00:00:19.259
各点が その色になる確率の 負の対数を 合計します

00:00:19.260 --> 00:00:22.170
その結果 右のモデルの方が 良いことが わかります

00:00:22.170 --> 00:00:25.860
クロスエントロピーが ずっと小さいためです

00:00:25.859 --> 00:00:29.269
では 誤差関数の式を 実際に 計算してみましょう

00:00:29.269 --> 00:00:31.559
2つのケースに 分けます

00:00:31.559 --> 00:00:34.269
最初のケースは y=1の 場合です

00:00:34.270 --> 00:00:36.130
つまり青の点です

00:00:36.130 --> 00:00:42.480
このモデルで 青である確率は ŷです

00:00:42.479 --> 00:00:47.849
そこで この2つの点の 確率は 0.6と 0.2です

00:00:47.850 --> 00:00:50.910
ご覧のとおり 青い領域にある点は

00:00:50.909 --> 00:00:55.000
青である確率が 赤い領域の点より 高くなります

00:00:55.000 --> 00:01:00.500
誤差は この確率の 負の対数です

00:01:00.500 --> 00:01:04.010
正確にいうと ŷの負の対数です

00:01:04.010 --> 00:01:09.665
図では 0.6の 負の対数と 0.2の 負の対数に なります

00:01:09.665 --> 00:01:13.745
さて y=0の場合 つまり赤の点については

00:01:13.745 --> 00:01:17.585
点が赤である確率を 計算する必要があります

00:01:17.584 --> 00:01:22.339
点が赤である確率は 1から 青である確率を 引いた値

00:01:22.340 --> 00:01:27.750
つまり 1-ŷです

00:01:27.750 --> 00:01:30.890
そこで 誤差は この確率の 負の対数

00:01:30.890 --> 00:01:35.870
つまり 1-ŷの 負の対数です

00:01:35.870 --> 00:01:42.040
この例では 0.1の 負の対数と 0.7 の負の対数 となります

00:01:42.040 --> 00:01:46.605
そのため 誤差は 青の点の場合は yの 負の対数です

00:01:46.605 --> 00:01:50.635
赤の点の場合は 1-ŷの 負の対数です

00:01:50.635 --> 00:01:53.625
この 2つの式を 1つにまとめましょう

00:01:53.625 --> 00:02:02.159
誤差 = - (1-y)(ln( 1- ŷ)) - y ln(ŷ)

00:02:02.159 --> 00:02:03.759
どうして この式で 計算できるのでしょうか

00:02:03.760 --> 00:02:05.730
点が青なら y=1なので

00:02:05.730 --> 00:02:10.664
1-y=0となり 最初の項が 0になります

00:02:10.664 --> 00:02:16.495
2つ目の項は 単に ŷの対数です

00:02:16.495 --> 00:02:20.219
同様に 点が赤なら y=0です

00:02:20.219 --> 00:02:27.680
そのため 2つ目の項が 0 となり 最初の項は 1-ŷです

00:02:27.680 --> 00:02:31.145
誤差関数の 計算式は 点の 誤差関数の

00:02:31.145 --> 00:02:35.510
総和であり このようになります

00:02:35.509 --> 00:02:38.564
これが 左側と等しい 4.8になります

00:02:38.564 --> 00:02:41.469
慣例では 和ではなく

00:02:41.469 --> 00:02:45.330
平均を取るので nで 割ります

00:02:45.330 --> 00:02:49.050
これで 4.8が 1.2に なります

00:02:49.050 --> 00:02:53.330
今後は この式を 誤差関数として 使用します

00:02:53.330 --> 00:02:58.860
さて ŷは 線形関数wx+bの シグモイド関数であることから

00:02:58.860 --> 00:03:01.890
誤差の計算式は

00:03:01.889 --> 00:03:05.094
モデルの重みである wと bで 表せます

00:03:05.094 --> 00:03:08.219
このような 式になります

00:03:08.219 --> 00:03:14.449
この例で y_iは 点xの ラベルに 添え字i を加えたものです

00:03:14.449 --> 00:03:17.364
誤差関数を 求めましたが 目標は その最小化です

00:03:17.365 --> 00:03:18.975
次の ステップで それを実行します

00:03:18.974 --> 00:03:20.293
これは 余談ですが

00:03:20.294 --> 00:03:23.210
ここで解いたのは 2項分類問題です

00:03:23.210 --> 00:03:25.670
多クラス分類問題の 場合は

00:03:25.669 --> 00:03:28.490
誤差は 多クラスエントロピーとなります

00:03:28.491 --> 00:03:33.380
式は このようになり 各データ点に対して

00:03:33.379 --> 00:03:39.139
ラベルと 予測の対数の 積を求め すべての値の 平均を計算します

00:03:39.139 --> 00:03:41.539
クラスが 2つの場合は どちらの式も 同じ結果になるので

00:03:41.539 --> 00:03:45.000
ぜひ 自分で 試してみてください


<!-- udacimak v1.4.4 -->
<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="ie=edge" http-equiv="X-UA-Compatible"/>
  <title>
   Details of Johansen Test (optional)
  </title>
  <link href="../assets/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="../assets/css/plyr.css" rel="stylesheet"/>
  <link href="../assets/css/katex.min.css" rel="stylesheet"/>
  <link href="../assets/css/jquery.mCustomScrollbar.min.css" rel="stylesheet"/>
  <link href="../assets/css/styles.css" rel="stylesheet"/>
  <link href="../assets/img/udacimak.png" rel="shortcut icon" type="image/png">
  </link>
 </head>
 <body>
  <div class="wrapper">
   <nav id="sidebar">
    <div class="sidebar-header">
     <h3>
      Pairs Trading and Mean Reversion
     </h3>
    </div>
    <ul class="sidebar-list list-unstyled CTAs">
     <li>
      <a class="article" href="../index.html">
       Back to Home
      </a>
     </li>
    </ul>
    <ul class="sidebar-list list-unstyled components">
     <li class="">
      <a href="01. Intro.html">
       01. Intro
      </a>
     </li>
     <li class="">
      <a href="02. Mean Reversion.html">
       02. Mean Reversion
      </a>
     </li>
     <li class="">
      <a href="03. Pairs Trading.html">
       03. Pairs Trading
      </a>
     </li>
     <li class="">
      <a href="04. Finding Pairs to Trade.html">
       04. Finding Pairs to Trade
      </a>
     </li>
     <li class="">
      <a href="05. Quiz Identify Pairs to Trade.html">
       05. Quiz: Identify Pairs to Trade
      </a>
     </li>
     <li class="">
      <a href="06. Cointegration.html">
       06. Cointegration
      </a>
     </li>
     <li class="">
      <a href="07. ADF and roots.html">
       07. ADF and roots
      </a>
     </li>
     <li class="">
      <a href="08. Clustering Stocks.html">
       08. Clustering Stocks
      </a>
     </li>
     <li class="">
      <a href="09. Trade Pairs of Stocks.html">
       09. Trade Pairs of Stocks
      </a>
     </li>
     <li class="">
      <a href="10. Exercise finding pairs.html">
       10. Exercise: finding pairs
      </a>
     </li>
     <li class="">
      <a href="11. Variations of Pairs Trading and Mean Reversion Trading.html">
       11. Variations of Pairs Trading and Mean Reversion Trading
      </a>
     </li>
     <li class="">
      <a href="12. 3 or more stocks (optional).html">
       12. 3 or more stocks (optional)
      </a>
     </li>
     <li class="">
      <a href="13. Details of Johansen Test (optional).html">
       13. Details of Johansen Test (optional)
      </a>
     </li>
     <li class="">
      <a href="14. Summary.html">
       14. Summary
      </a>
     </li>
    </ul>
    <ul class="sidebar-list list-unstyled CTAs">
     <li>
      <a class="article" href="../index.html">
       Back to Home
      </a>
     </li>
    </ul>
   </nav>
   <div id="content">
    <header class="container-fluild header">
     <div class="container">
      <div class="row">
       <div class="col-12">
        <div class="align-items-middle">
         <button class="btn btn-toggle-sidebar" id="sidebarCollapse" type="button">
          <div>
          </div>
          <div>
          </div>
          <div>
          </div>
         </button>
         <h1 style="display: inline-block">
          13. Details of Johansen Test (optional)
         </h1>
        </div>
       </div>
      </div>
     </div>
    </header>
    <main class="container">
     <div class="row">
      <div class="col-12">
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <h2 id="details-of-the-johansen-test-very-optional">
          Details of the Johansen test (very optional)
         </h2>
         <p>
          So you may be wondering how we get these coefficients, and also how we check whether three stocks have a cointegrated relationship.  For a closer look, let’s introduce a bit of math.  Recall from the lesson on time series, that a vector autoregression attempts to describe a stock’s current value based on not only its prior values, but also the prior values of other stocks.  Let’s use two stocks as an example:  Note, I’m using the variable names “IBM” and “GE” to refer to the price series of these stocks. The
          <span class="mathquill ud-math">
           \mu
          </span>
          refers to a historical average for each stock’s time series.  The “e” refers to an error term for each stock.
         </p>
         <p>
          <span class="mathquill ud-math">
           IBM_{t} = \mu_{IBM} + \beta_{1,1} \times IBM_{t-1} + \beta_{1,2} \times GE_{t-1} + e_{1,t}
          </span>
         </p>
         <p>
          <span class="mathquill ud-math">
           GE_{t} = \mu_{GE} + \beta_{2,1} \times IBM_{t-1} + \beta_{2,2} \times GE_{t-1} + e_{2,t}
          </span>
         </p>
         <p>
          We normally use matrices to make this easier to work with, so the equations above can be written as:
          <br/>
          <span class="mathquill ud-math">
           \begin{bmatrix}IBM_t\\ GE_t\end{bmatrix}=\begin{bmatrix}\mu_{IBM} \\\mu_{GE}\end{bmatrix}+\begin{bmatrix}\beta_{1,1} &amp; \beta_{1,2}\\ \beta_{2,1} &amp; \beta_{2,2} \end{bmatrix}\begin{bmatrix}IBM_{t-1}\\ GE_{t-1}\end{bmatrix}+ \begin{bmatrix}e_{1,t}\\ e_{2,t}\end{bmatrix}
          </span>
         </p>
         <p>
          To make things simpler to write, we’ll write the 2 x 2 matrix of betas with a capital B, and we’ll denote the vector of the two stocks with a lowercase x.  We’ll write the vector of
          <span class="mathquill ud-math">
           \mu
          </span>
          ’s with a single
          <span class="mathquill ud-math">
           \mu
          </span>
          , and so on.  So the vector autoregression with a lag of one is:
         </p>
         <p>
          <span class="mathquill ud-math">
           x_{t} = \mu + B x_{t-1} + e_{t}
          </span>
         </p>
         <p>
          For a lag of p, this formula looks like
          <br/>
          <span class="mathquill ud-math">
           x_{t} = \mu + B_1 x_{t-1} + … + B_p x_{t-p}+ e_{t}
          </span>
         </p>
         <p>
          Now, if you recall from studying cointegrated time series, taking the time-wise difference may help us create a stationary series.  So we’ll denote the timewise difference as:
          <br/>
          As
          <br/>
          <span class="mathquill ud-math">
           \Delta x_{t} = x_{t} - x_{t-1}
          </span>
         </p>
         <p>
          Next, we can define x_t in using a Vector Error Correction Model (VECM) like this:
          <br/>
          <span class="mathquill ud-math">
           \Delta x_{t} = \mu + Bx_{t-1} + C_1\Delta x_{t-1} + C_p \Delta x_{t-p} + e_t
          </span>
         </p>
         <p>
          Notice how the
          <span class="mathquill ud-math">
           B x_{t-1}
          </span>
          term is just the vector of the previous periods’ values, and not the time-wise difference like the other terms.  All of the subsequent terms to its right are time-wise differences.  The Johansen test checks how many rows in the matrix B are needed to form a cointegrated series.  To do this, it does some math, using an eigenvalue decomposition (let’s not worry about it for now), to determine how likely the matrix B has a rank of 0, or 1, 2, or 3, up to the number of stocks that we’re looking at (most likely 2 or 3).
         </p>
         <p>
          Here’s a quick refresher on what the rank of a matrix is.
         </p>
         <p>
          If you have three equations like this:
         </p>
         <p>
          <span class="mathquill ud-math">
           1x + 1y = 1
          </span>
         </p>
         <p>
          <span class="mathquill ud-math">
           2x + 2y = 2
          </span>
         </p>
         <p>
          <span class="mathquill ud-math">
           3x + 3y = 3
          </span>
         </p>
         <p>
          What do you notice about all of these equations?  It looks like you only need one of the equations to describe all three of them.  In this case, we’d say that the rank is 1.
         </p>
         <p>
          Similarly, when the Johansen test checks whether the rank of matrix B is 0, 1, 2 or 3, let’s see what this means for us practically.  If we were trying to see if 3 stocks were cointegrated, and the Johansen test estimated that the rank of matrix B was 3, then we’d assume that all three stocks form a cointegrated relationship.  If, on the other hand, the Johansen test results showed that the rank of matrix B was likely 2, then only 2 of the 3 stocks are necessary to form a cointegrated relationship.  So we’d want to try out all the pairs of stocks to see which two are cointegrated.  If the rank was zero, then that means there was no cointegration among the stocks that we looked at.
         </p>
         <p>
          To determine the rank, the Johansen test actually does a hypothesis test on whether the rank is 0, 1, 2 or 3, up to the number of stocks there are in the test (probably 2 or 3).   Looking at the t-statistic or p-value can let you decide with a certain level of confidence if at least two or even three of these stocks form a cointegrated series.
         </p>
         <p>
          Okay, we’re almost there!  The Johansen test gives us a vector that we can use as the weights we assign to each stock.  If you are curious, this is the largest eigenvector that’s generated by the eigenvalue decomposition.  But again, let’s not worry about how to do eigenvalue decomposition, and just see how to use this vector of weights.  These are the weights that we mentioned earlier when computing the linear combination of the stock prices, which is used in the same way as the spread.
         </p>
         <p>
          So if we get
          <span class="mathquill ud-math">
           w_1, w_2, w_3
          </span>
          from the eigenvector w, we use these as weights on each stock, as we saw earlier:
         </p>
         <p>
          <span class="mathquill ud-math">
           w_1 \times stock_1 + w_2 \times stock_2 + w_3 \times stock_3 = spread
          </span>
         </p>
         <p>
          To summarize, the Johansen test figures out whether a group of stocks is cointegrated, and if so, how to calculate a “spread” that we’ll keep track of for temporary deviations from its historical average.  It also gives us the proportion of shares to trade for each stock.
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
      </div>
      <div class="col-12">
       <p class="text-right">
        <a class="btn btn-outline-primary mt-4" href="14. Summary.html" role="button">
         Next Concept
        </a>
       </p>
      </div>
     </div>
    </main>
    <footer class="footer">
     <div class="container">
      <div class="row">
       <div class="col-12">
        <p class="text-center">
         udacity2.0 If you need the newest courses Plase add me wechat: udacity6
        </p>
       </div>
      </div>
     </div>
    </footer>
   </div>
  </div>
  <script src="../assets/js/jquery-3.3.1.min.js">
  </script>
  <script src="../assets/js/plyr.polyfilled.min.js">
  </script>
  <script src="../assets/js/bootstrap.min.js">
  </script>
  <script src="../assets/js/jquery.mCustomScrollbar.concat.min.js">
  </script>
  <script src="../assets/js/katex.min.js">
  </script>
  <script>
   // Initialize Plyr video players
    const players = Array.from(document.querySelectorAll('video')).map(p => new Plyr(p));

    // render math equations
    let elMath = document.getElementsByClassName('mathquill');
    for (let i = 0, len = elMath.length; i < len; i += 1) {
      const el = elMath[i];

      katex.render(el.textContent, el, {
        throwOnError: false
      });
    }

    // this hack will make sure Bootstrap tabs work when using Handlebars
    if ($('#question-tabs').length && $('#user-answer-tabs').length) {
      $("#question-tabs a.nav-link").on('click', function () {
        $("#question-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
      $("#user-answer-tabs a.nav-link").on('click', function () {
        $("#user-answer-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
    } else {
      $("a.nav-link").on('click', function () {
        $(".tab-pane").hide();
        $($(this).attr("href")).show();
      });
    }

    // side bar events
    $(document).ready(function () {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });

      // scroll to first video on page loading
      if ($('video').length) {
        $('html,body').animate({ scrollTop: $('div.plyr').prev().offset().top});
      }

      // auto play first video: this may not work with chrome/safari due to autoplay policy
      if (players && players.length > 0) {
        players[0].play();
      }

      // scroll sidebar to current concept
      const currentInSideBar = $( "ul.sidebar-list.components li a:contains('13. Details of Johansen Test (optional)')" )
      currentInSideBar.css( "text-decoration", "underline" );
      $("#sidebar").mCustomScrollbar('scrollTo', currentInSideBar);
    });
  </script>
 </body>
</html>
